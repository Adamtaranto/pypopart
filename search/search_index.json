{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"PyPopART Documentation","text":"<p>Welcome to PyPopART - a pure Python implementation of PopART (Population Analysis with Reticulate Trees) for constructing and visualizing haplotype networks from DNA sequence data.</p>"},{"location":"#overview","title":"Overview","text":"<p>PyPopART provides a complete toolkit for:</p> <ul> <li>Network Construction: Six algorithms (MST, MSN, TCS, MJN, PN, TSW)</li> <li>Distance Calculation: Multiple evolutionary models</li> <li>Network Analysis: Comprehensive statistics and topology analysis</li> <li>Visualization: Static, interactive, and web-based network plots</li> <li>Population Genetics: Diversity measures, FST, Tajima's D, and more</li> <li>Dual Interface: Command-line tools and web-based GUI</li> </ul>"},{"location":"#key-features","title":"Key Features","text":""},{"location":"#multiple-algorithms","title":"\ud83c\udf33 Multiple Algorithms","text":"<ul> <li>MST (Minimum Spanning Tree): Simplest tree-based network</li> <li>MSN (Minimum Spanning Network): Shows alternative connections</li> <li>TCS (Statistical Parsimony): Statistically justified connections</li> <li>MJN (Median-Joining): Infers ancestral haplotypes</li> <li>PN (Parsimony Network): Consensus from multiple trees</li> <li>TSW (Tight Span Walker): Metric-preserving network construction</li> </ul>"},{"location":"#distance-metrics","title":"\ud83d\udccf Distance Metrics","text":"<ul> <li>Hamming distance</li> <li>Jukes-Cantor correction</li> <li>Kimura 2-parameter</li> <li>Tamura-Nei model</li> </ul>"},{"location":"#comprehensive-analysis","title":"\ud83d\udcca Comprehensive Analysis","text":"<ul> <li>Network statistics (diameter, clustering, centrality)</li> <li>Topology analysis (star patterns, hubs, bridges)</li> <li>Population genetics measures (Tajima's D, Fu's Fs, FST)</li> <li>Diversity metrics (nucleotide, haplotype, Shannon)</li> </ul>"},{"location":"#rich-visualization","title":"\ud83c\udfa8 Rich Visualization","text":"<ul> <li>Static plots with matplotlib (PNG, PDF, SVG)</li> <li>Interactive plots with Plotly (HTML)</li> <li>Multiple layout algorithms</li> <li>Customizable colors, sizes, and labels</li> </ul>"},{"location":"#flexible-io","title":"\ud83d\udcc1 Flexible I/O","text":"<ul> <li>Input: FASTA, NEXUS, PHYLIP, GenBank</li> <li>Output: GraphML, GML, JSON, NEXUS</li> <li>Metadata support (populations, traits, locations)</li> </ul>"},{"location":"#entry-points","title":"Entry Points","text":"<p>PyPopART offers two interfaces for different workflows:</p>"},{"location":"#command-line-interface-cli","title":"Command-Line Interface (CLI)","text":"<p>For automation, scripting, and batch processing:</p> <pre><code># Get help\npypopart --help\n\n# List available algorithms\npypopart info --list-algorithms\n\n# Construct a median-joining network\npypopart network sequences.fasta -o network.graphml\n\n# Visualize the network\npypopart visualize network.graphml -o network.png\n</code></pre>"},{"location":"#web-based-gui","title":"Web-based GUI","text":"<p>For interactive analysis and exploration:</p> <pre><code># Start the GUI application\npypopart-gui\n\n# Opens web interface at http://localhost:8050\n# or specify custom port:\npypopart-gui --port 8080\n</code></pre> <p>The GUI provides: - Drag-and-drop file upload - Interactive network visualization (zoom, pan, drag nodes) - Real-time algorithm parameter adjustment - Population-based coloring with pie charts - Multiple layout algorithms - Network statistics and haplotype summaries - Export to various formats</p>"},{"location":"#quick-examples","title":"Quick Examples","text":""},{"location":"#command-line-workflow","title":"Command Line Workflow","text":"<pre><code># Load and validate sequences\npypopart load sequences.fasta\n\n# Construct network with TCS algorithm\npypopart network sequences.fasta -a tcs -o network.graphml\n\n# Analyze network statistics\npypopart analyze network.graphml --stats\n\n# Create visualization\npypopart visualize network.graphml -o network.png\n</code></pre>"},{"location":"#python-api","title":"Python API","text":"<pre><code>from pypopart.io import load_alignment\nfrom pypopart.algorithms import MJNAlgorithm\nfrom pypopart.core.distance import DistanceCalculator\nfrom pypopart.core.condensation import condense_alignment\nfrom pypopart.visualization import StaticVisualizer\n\n# Load data\nalignment = load_alignment('sequences.fasta')\n\n# Calculate distances\ncalc = DistanceCalculator(method='k2p')\ndistances = calc.calculate_matrix(alignment)\n\n# Build network\nhaplotypes, _ = condense_alignment(alignment)\nmjn = MJNAlgorithm(epsilon=0)\nnetwork = mjn.construct_network(haplotypes, distances)\n\n# Visualize\nviz = StaticVisualizer(network)\nviz.plot(output_file='network.png')\n</code></pre>"},{"location":"#getting-started","title":"Getting Started","text":"<ul> <li>Installation: Install PyPopART</li> <li>Quick Start: Your first haplotype network</li> <li>Basic Concepts: Understanding haplotype networks</li> </ul>"},{"location":"#user-guide","title":"User Guide","text":"<ul> <li>CLI Guide: Command-line interface</li> <li>Python API: Programmatic usage</li> <li>Algorithms: Choosing the right algorithm</li> <li>Visualization: Creating beautiful plots</li> </ul>"},{"location":"#tutorials","title":"Tutorials","text":"<ul> <li>Basic Workflow: Complete example</li> <li>Algorithm Comparison: Compare all algorithms</li> <li>Visualization Options: Customize your plots</li> <li>Population Genetics: Genetic diversity analysis</li> </ul>"},{"location":"#api-reference","title":"API Reference","text":"<p>Detailed documentation for all classes and functions:</p> <ul> <li>Core Classes: Sequence, Alignment, Haplotype</li> <li>Algorithms: Network construction</li> <li>Visualization: Plotting functions</li> <li>Statistics: Analysis tools</li> </ul>"},{"location":"#about","title":"About","text":"<p>PyPopART is developed and maintained by Adam Taranto. It is inspired by the original PopART software by Jessica Leigh and David Bryant.</p> <p>License: GNU General Public License v3.0 or later</p> <p>Citation: If you use PyPopART in your research, please cite:</p> <pre><code>Taranto, A. (2024). PyPopART: Pure Python implementation of haplotype network analysis.\nGitHub repository: https://github.com/adamtaranto/pypopart\n</code></pre>"},{"location":"#need-help","title":"Need Help?","text":"<ul> <li>FAQ: Frequently asked questions</li> <li>GitHub Issues: Report bugs or request features</li> <li>Contributing: Contribute to PyPopART</li> </ul>"},{"location":"CYTOSCAPE_MIGRATION/","title":"Cytoscape Network Visualization Migration","text":""},{"location":"CYTOSCAPE_MIGRATION/#overview","title":"Overview","text":"<p>The PyPopART Dash application now uses Dash Cytoscape for network visualization, replacing the previous Plotly-based graphs. This migration provides improved interactivity, manual node repositioning, and better support for complex network features.</p>"},{"location":"CYTOSCAPE_MIGRATION/#key-features","title":"Key Features","text":""},{"location":"CYTOSCAPE_MIGRATION/#1-manual-node-repositioning","title":"1. Manual Node Repositioning","text":"<p>What it does: Nodes can be dragged and repositioned manually using the mouse.</p> <p>How to use: - Click and hold on any node in the network - Drag it to a new position - Release to place the node - The new position is automatically saved</p> <p>Snap to Grid: Enable the \"Snap to Grid\" option in the Layout Options panel to align nodes to a grid when released.</p>"},{"location":"CYTOSCAPE_MIGRATION/#2-population-visualization","title":"2. Population Visualization","text":""},{"location":"CYTOSCAPE_MIGRATION/#single-population-nodes","title":"Single Population Nodes","text":"<p>Nodes containing samples from a single population are displayed with the population's assigned color.</p>"},{"location":"CYTOSCAPE_MIGRATION/#mixed-population-nodes","title":"Mixed Population Nodes","text":"<p>Nodes containing samples from multiple populations are displayed as pie charts: - Each segment represents a population, sized by its proportion - Segment colors match the population colors from the legend - Pie charts are generated as SVG and embedded as node backgrounds - Hover over the node to see the exact population breakdown</p>"},{"location":"CYTOSCAPE_MIGRATION/#3-legend-display","title":"3. Legend Display","text":"<p>The legend (top right corner) shows: - Population colors: Circle markers with population names - Mixed populations indicator: Pie icon (\u25d5) indicating nodes with pie chart visualization - Median vectors: Gray square (\u25a0) for inferred median vector nodes</p>"},{"location":"CYTOSCAPE_MIGRATION/#4-edge-labels","title":"4. Edge Labels","text":"<p>Edges display the number of mutations between connected haplotypes as numeric labels.</p>"},{"location":"CYTOSCAPE_MIGRATION/#5-interactive-controls","title":"5. Interactive Controls","text":"<p>Zoom: Use mouse wheel or pinch gesture to zoom in/out</p> <p>Pan: Click and drag on the background to move the entire network</p> <p>Select: Click on nodes to select them (highlighted with red border)</p> <p>Hover: Mouse over nodes or edges to see detailed information</p>"},{"location":"CYTOSCAPE_MIGRATION/#technical-details","title":"Technical Details","text":""},{"location":"CYTOSCAPE_MIGRATION/#cytoscape-elements-structure","title":"Cytoscape Elements Structure","text":"<p>Each node element contains: - <code>id</code>: Unique haplotype identifier (e.g., \"H1\", \"H2\") - <code>label</code>: Display label - <code>size</code>: Visual size based on frequency - <code>color</code>: Node color (population-based, transparent for pie charts, or default) - <code>is_median</code>: Boolean indicating if this is a median vector - <code>has_pie</code>: Boolean indicating mixed population composition - <code>pie_data</code>: Array of population frequency data (for mixed nodes) - <code>pie_svg</code>: SVG Data URI containing the pie chart visualization (for mixed nodes)</p> <p>Each edge element contains: - <code>id</code>: Unique edge identifier - <code>source</code>: Source node ID - <code>target</code>: Target node ID - <code>weight</code>: Genetic distance (mutation count) - <code>label</code>: Distance label for display</p>"},{"location":"CYTOSCAPE_MIGRATION/#layout-algorithms","title":"Layout Algorithms","text":"<p>Available layout algorithms: - Spring (Force-directed): Physically-simulated layout - Circular: Nodes arranged in a circle - Radial: Radial tree layout - Hierarchical: Hierarchical tree structure - Kamada-Kawai: Force-directed with minimum energy - Spring/KK Proportional: Edge lengths proportional to mutation distances</p>"},{"location":"CYTOSCAPE_MIGRATION/#color-generation","title":"Color Generation","text":"<p>When population colors are not specified in metadata: - Colors are automatically generated using HSV color space - Evenly distributed hues for maximum distinction - High saturation and value for vivid colors</p>"},{"location":"CYTOSCAPE_MIGRATION/#migration-from-plotly","title":"Migration from Plotly","text":""},{"location":"CYTOSCAPE_MIGRATION/#what-changed","title":"What Changed","text":"<ol> <li>Component Type: <code>dcc.Graph</code> \u2192 <code>cyto.Cytoscape</code></li> <li>Data Format: Plotly figure traces \u2192 Cytoscape elements</li> <li>Callbacks: Updated to handle Cytoscape events</li> <li>Node Positioning: Now directly editable by users</li> </ol>"},{"location":"CYTOSCAPE_MIGRATION/#what-stayed-the-same","title":"What Stayed the Same","text":"<ul> <li>All network algorithms (MST, MSN, TCS, MJN)</li> <li>Layout computation methods</li> <li>Metadata support</li> <li>Export functionality</li> <li>Statistics calculations</li> <li>Haplotype summary</li> </ul>"},{"location":"CYTOSCAPE_MIGRATION/#api-changes","title":"API Changes","text":""},{"location":"CYTOSCAPE_MIGRATION/#interactivecytoscapeplotter","title":"InteractiveCytoscapePlotter","text":"<p>New class for creating Cytoscape visualizations:</p> <pre><code>from pypopart.visualization.cytoscape_plot import (\n    InteractiveCytoscapePlotter,\n    create_cytoscape_network\n)\n\n# Create plotter\nplotter = InteractiveCytoscapePlotter(network)\n\n# Generate elements and stylesheet\nelements = plotter.create_elements(\n    layout=positions,\n    population_colors={'PopA': '#FF0000', 'PopB': '#0000FF'},\n    show_labels=True,\n    show_edge_labels=True,\n)\n\nstylesheet = plotter.create_stylesheet(\n    population_colors=population_colors,\n)\n\n# Or use convenience function\nelements, stylesheet = create_cytoscape_network(\n    network,\n    layout=positions,\n    population_colors=population_colors,\n)\n</code></pre>"},{"location":"CYTOSCAPE_MIGRATION/#convenience-functions","title":"Convenience Functions","text":"<pre><code># Auto-generate population colors\ncolors = plotter.generate_population_colors(['PopA', 'PopB', 'PopC'])\n\n# Create pie chart styles\npie_styles = plotter.create_pie_stylesheet(population_colors)\n</code></pre>"},{"location":"CYTOSCAPE_MIGRATION/#backward-compatibility","title":"Backward Compatibility","text":"<p>The original Plotly-based <code>InteractiveNetworkPlotter</code> is still available and unchanged:</p> <pre><code>from pypopart.visualization.interactive_plot import InteractiveNetworkPlotter\n\n# Still works as before\nplotter = InteractiveNetworkPlotter(network)\nfig = plotter.plot(layout=positions)\n</code></pre>"},{"location":"CYTOSCAPE_MIGRATION/#testing","title":"Testing","text":"<p>Comprehensive test suite in <code>tests/unit/test_cytoscape_plot.py</code>: - Element creation and structure - Node sizing and coloring - Population data handling - Edge labels - Stylesheet generation - Empty and edge cases</p> <p>Run tests: <pre><code>pytest tests/unit/test_cytoscape_plot.py -v\n</code></pre></p>"},{"location":"CYTOSCAPE_MIGRATION/#future-enhancements","title":"Future Enhancements","text":"<p>Potential improvements for future versions: - True pie chart rendering using custom Cytoscape.js extensions - Animation support for layout transitions - Advanced selection and filtering tools - Export to Cytoscape.js format - Custom node shapes for different haplotype types</p>"},{"location":"faq/","title":"Frequently Asked Questions","text":""},{"location":"faq/#general","title":"General","text":""},{"location":"faq/#what-is-pypopart","title":"What is PyPopART?","text":"<p>PyPopART is a pure Python implementation of PopART (Population Analysis with Reticulate Trees), a tool for constructing and visualizing haplotype networks from DNA sequence alignments.</p>"},{"location":"faq/#how-is-pypopart-different-from-the-original-popart","title":"How is PyPopART different from the original PopART?","text":"<ul> <li>Pure Python: No Java dependency, easier to install</li> <li>CLI and API: Both command-line and programmatic access</li> <li>Modern stack: Uses current Python libraries (NetworkX, Plotly)</li> <li>Open development: Active development on GitHub</li> <li>Additional features: More analysis options and statistics</li> </ul>"},{"location":"faq/#is-pypopart-compatible-with-popart-files","title":"Is PyPopART compatible with PopART files?","text":"<p>Yes! PyPopART can read NEXUS files with traits/metadata in PopART format, and can export networks in formats compatible with PopART.</p>"},{"location":"faq/#installation","title":"Installation","text":""},{"location":"faq/#which-python-version-do-i-need","title":"Which Python version do I need?","text":"<p>Python 3.9 or higher. We recommend Python 3.11 or 3.12 for best performance.</p>"},{"location":"faq/#can-i-use-pypopart-on-windows","title":"Can I use PyPopART on Windows?","text":"<p>Yes! PyPopART works on Windows, macOS, and Linux.</p>"},{"location":"faq/#installation-fails-with-numpyscipy-errors","title":"Installation fails with NumPy/SciPy errors","text":"<p>Try installing NumPy and SciPy first:</p> <pre><code>pip install numpy scipy\npip install pypopart\n</code></pre> <p>On some systems, you may need system dependencies for NumPy/SciPy. See your OS package manager docs.</p>"},{"location":"faq/#usage","title":"Usage","text":""},{"location":"faq/#which-algorithm-should-i-use","title":"Which algorithm should I use?","text":"<ul> <li>MST: Simplest, always gives a tree</li> <li>MSN: Shows alternative connections, slightly more complex</li> <li>TCS: Statistically justified, may give disconnected networks</li> <li>MJN: Most comprehensive, infers ancestral haplotypes</li> </ul> <p>See the Algorithm Guide for detailed comparison.</p>"},{"location":"faq/#which-distance-metric-should-i-use","title":"Which distance metric should I use?","text":"<ul> <li>Hamming: Simple differences, fast, good for closely related sequences</li> <li>Jukes-Cantor: Corrects for multiple substitutions</li> <li>K2P: Accounts for transition/transversion differences</li> <li>Tamura-Nei: Most complex, accounts for GC content and rate variation</li> </ul> <p>For most cases, Hamming or K2P is sufficient.</p>"},{"location":"faq/#my-network-is-too-complex-how-can-i-simplify-it","title":"My network is too complex, how can I simplify it?","text":"<p>For MJN networks:</p> <pre><code>pypopart network sequences.fasta -a mjn -e 10 -o network.graphml\n</code></pre> <p>Increase epsilon (e.g., 5, 10, 20) to reduce complexity.</p> <p>For TCS networks, increase the parsimony limit:</p> <pre><code>pypopart network sequences.fasta -a tcs -p 0.99 -o network.graphml\n</code></pre> <p>Or use a simpler algorithm (MST or MSN).</p>"},{"location":"faq/#my-tcs-network-is-disconnected-is-this-a-bug","title":"My TCS network is disconnected, is this a bug?","text":"<p>No, this is expected behavior! TCS only connects haplotypes within the parsimony limit. Disconnected components may represent distinct lineages or insufficient data.</p>"},{"location":"faq/#how-do-i-add-populationmetadata-information","title":"How do I add population/metadata information?","text":"<p>Create a CSV file with columns including 'id' and any metadata:</p> <pre><code>id,population,location\nSeq1,PopA,Site1\nSeq2,PopA,Site1\nSeq3,PopB,Site2\n</code></pre> <p>Then:</p> <pre><code>pypopart load sequences.fasta -m metadata.csv\npypopart visualize network.graphml --color-by population -o network.png\n</code></pre>"},{"location":"faq/#can-i-visualize-networks-from-other-software","title":"Can I visualize networks from other software?","text":"<p>If the network is in GraphML, GML, or JSON format, yes! Load it:</p> <pre><code>pypopart visualize external_network.graphml -o plot.png\n</code></pre>"},{"location":"faq/#visualization","title":"Visualization","text":""},{"location":"faq/#how-do-i-make-publication-quality-figures","title":"How do I make publication-quality figures?","text":"<p>Use PDF output for vector graphics:</p> <pre><code>pypopart visualize network.graphml -o network.pdf --width 1200 --height 1200\n</code></pre> <p>For highest quality:</p> <ul> <li>Use larger dimensions (1200+ pixels)</li> <li>Use vector formats (PDF, SVG)</li> <li>Show labels only if needed</li> <li>Use spring layout for complex networks</li> </ul>"},{"location":"faq/#node-sizes-dont-reflect-my-sample-sizes","title":"Node sizes don't reflect my sample sizes","text":"<p>Node sizes are based on haplotype frequency. Make sure frequency information is preserved in your network file. When constructing from alignment, frequencies are automatically calculated.</p>"},{"location":"faq/#how-do-i-customize-colors","title":"How do I customize colors?","text":"<p>Currently, colors are assigned automatically. For custom coloring:</p> <pre><code>from pypopart.visualization import StaticVisualizer\n\nviz = StaticVisualizer(network)\ncustom_colors = {'Hap1': 'red', 'Hap2': 'blue', ...}\nviz.plot(node_colors=custom_colors, output_file='network.png')\n</code></pre>"},{"location":"faq/#can-i-export-interactive-plots","title":"Can I export interactive plots?","text":"<p>Yes! Use HTML format:</p> <pre><code>pypopart visualize network.graphml -o network.html --interactive\n</code></pre> <p>Open the HTML file in any web browser for interactive exploration.</p>"},{"location":"faq/#performance","title":"Performance","text":""},{"location":"faq/#pypopart-is-slow-with-my-large-dataset","title":"PyPopART is slow with my large dataset","text":"<p>For datasets &gt;1000 sequences:</p> <ol> <li>Use simpler algorithms (MST, MSN instead of MJN)</li> <li>Use Hamming distance instead of complex models</li> <li>For MJN, increase epsilon to reduce complexity</li> <li>Consider subsampling if haplotype diversity is low</li> </ol>"},{"location":"faq/#can-i-parallelize-the-analysis","title":"Can I parallelize the analysis?","text":"<p>Currently, PyPopART runs single-threaded for most operations. Parallel processing may be added in future releases.</p>"},{"location":"faq/#analysis","title":"Analysis","text":""},{"location":"faq/#what-statistics-should-i-report","title":"What statistics should I report?","text":"<p>Common statistics include:</p> <ul> <li>Number of haplotypes</li> <li>Haplotype diversity</li> <li>Nucleotide diversity</li> <li>Network diameter</li> <li>Number of reticulations</li> </ul> <p>Use:</p> <pre><code>pypopart analyze network.graphml --stats --topology\n</code></pre>"},{"location":"faq/#how-do-i-calculate-fst-between-populations","title":"How do I calculate FST between populations?","text":"<pre><code>from pypopart.stats import PopulationGeneticsAnalysis\nfrom pypopart.io import load_alignment\n\nalignment = load_alignment('sequences.fasta')\npopgen = PopulationGeneticsAnalysis(alignment)\n\n# Define populations\npopulations = {\n    'PopA': ['Seq1', 'Seq2'],\n    'PopB': ['Seq3', 'Seq4']\n}\n\n# Calculate FST\nfst = popgen.calculate_pairwise_fst(populations)\nprint(f\"FST = {fst:.4f}\")\n</code></pre>"},{"location":"faq/#what-does-reticulation-index-mean","title":"What does reticulation index mean?","text":"<p>Reticulation index measures network complexity:</p> <ul> <li>0 = tree (no cycles)</li> <li>Higher values = more reticulate (more cycles)</li> </ul> <p>It's calculated as: (edges - nodes + 1) / nodes</p>"},{"location":"faq/#errors","title":"Errors","text":""},{"location":"faq/#sequence-length-doesnt-match-alignment-length","title":"\"Sequence length doesn't match alignment length\"","text":"<p>All sequences in an alignment must have the same length. Check your input file for sequences of different lengths.</p>"},{"location":"faq/#sequence-id-already-exists","title":"\"Sequence ID already exists\"","text":"<p>Sequence IDs must be unique. Check for duplicate sequence names in your input file.</p>"},{"location":"faq/#distance-matrix-is-not-square","title":"\"Distance matrix is not square\"","text":"<p>This usually indicates a bug. Please report it on GitHub with your data and command.</p>"},{"location":"faq/#cannot-import-name-version","title":"\"Cannot import name 'version'\"","text":"<p>The package wasn't installed correctly. Try:</p> <pre><code>pip uninstall pypopart\npip install pypopart\n</code></pre>"},{"location":"faq/#file-formats","title":"File Formats","text":""},{"location":"faq/#what-input-formats-are-supported","title":"What input formats are supported?","text":"<ul> <li>FASTA (.fasta, .fa, .fna)</li> <li>NEXUS (.nexus, .nex)</li> <li>PHYLIP (.phy, .phylip)</li> <li>GenBank (.gb, .gbk)</li> </ul> <p>Compressed files (.gz, .zip) are automatically detected and decompressed.</p>"},{"location":"faq/#what-output-formats-are-available","title":"What output formats are available?","text":"<p>Networks:</p> <ul> <li>GraphML (.graphml) - Recommended</li> <li>GML (.gml)</li> <li>JSON (.json)</li> <li>NEXUS (.nexus, .nex)</li> </ul> <p>Visualizations:</p> <ul> <li>PNG (.png) - Raster</li> <li>PDF (.pdf) - Vector, publication-ready</li> <li>SVG (.svg) - Vector, web-friendly</li> <li>HTML (.html) - Interactive</li> </ul>"},{"location":"faq/#can-i-convert-between-formats","title":"Can I convert between formats?","text":"<p>Yes:</p> <pre><code># Load in one format, save in another\npypopart network sequences.fasta -o network.graphml\n# Convert to JSON\npython -c \"\nfrom pypopart.io import load_network, save_network\nnet = load_network('network.graphml')\nsave_network(net, 'network.json', format='json')\n\"\n</code></pre>"},{"location":"faq/#development","title":"Development","text":""},{"location":"faq/#how-can-i-contribute","title":"How can I contribute?","text":"<p>See CONTRIBUTING.md for guidelines.</p>"},{"location":"faq/#where-should-i-report-bugs","title":"Where should I report bugs?","text":"<p>Open an issue on GitHub with:</p> <ul> <li>Python and PyPopART versions</li> <li>Command or code that caused the error</li> <li>Full error message</li> <li>Sample data if possible</li> </ul>"},{"location":"faq/#can-i-request-features","title":"Can I request features?","text":"<p>Yes! Open an issue on GitHub describing:</p> <ul> <li>The use case</li> <li>Proposed functionality</li> <li>Examples from other tools (if applicable)</li> </ul>"},{"location":"faq/#citation","title":"Citation","text":""},{"location":"faq/#how-do-i-cite-pypopart","title":"How do I cite PyPopART?","text":"<pre><code>Taranto, A. (2024). PyPopART: Pure Python implementation of haplotype network analysis.\nGitHub repository: https://github.com/adamtaranto/pypopart\n</code></pre> <p>BibTeX:</p> <pre><code>@software{pypopart,\n  author = {Taranto, Adam},\n  title = {PyPopART: Pure Python implementation of haplotype network analysis},\n  year = {2024},\n  url = {https://github.com/adamtaranto/pypopart}\n}\n</code></pre>"},{"location":"faq/#still-have-questions","title":"Still Have Questions?","text":"<ul> <li>Check the User Guide</li> <li>Read the Tutorials</li> <li>Search GitHub Issues</li> <li>Open a new issue with the \"question\" label</li> </ul>"},{"location":"gui_usage/","title":"PyPopART GUI Usage Guide","text":""},{"location":"gui_usage/#overview","title":"Overview","text":"<p>PyPopART provides a web-based graphical user interface (GUI) built with Dash for interactive haplotype network analysis. The GUI offers an intuitive workflow for:</p> <ol> <li>Uploading sequence alignments</li> <li>Computing haplotype networks</li> <li>Visualizing and analyzing results</li> <li>Exporting networks and figures</li> </ol>"},{"location":"gui_usage/#installation","title":"Installation","text":"<p>Ensure you have PyPopART installed with GUI dependencies:</p> <pre><code>pip install pypopart\n# Or install in development mode:\npip install -e .\n</code></pre> <p>The GUI requires the following additional dependencies (automatically installed):</p> <ul> <li>dash</li> <li>dash-bootstrap-components</li> </ul>"},{"location":"gui_usage/#launching-the-gui","title":"Launching the GUI","text":""},{"location":"gui_usage/#from-command-line","title":"From Command Line","text":"<p>The easiest way to start the GUI:</p> <pre><code># Start on default port 8050\npypopart-gui\n\n# Start on custom port\npypopart-gui --port 8080\n\n# Enable debug mode\npypopart-gui --debug\n</code></pre>"},{"location":"gui_usage/#from-python","title":"From Python","text":"<pre><code>from pypopart.gui.app import main\n\n# Launch with default settings (port 8050, debug=False)\nmain()\n\n# Or customize:\nmain(debug=True, port=8080)\n</code></pre> <p>The GUI will start a local web server. Open your browser to <code>http://localhost:8050</code> (or your specified port).</p>"},{"location":"gui_usage/#using-the-gui","title":"Using the GUI","text":""},{"location":"gui_usage/#1-upload-data","title":"1. Upload Data","text":""},{"location":"gui_usage/#sequence-file-required","title":"Sequence File (Required)","text":"<ul> <li>Click \"\ud83d\udcc1 Select Sequence File\"</li> <li>Supported formats:</li> <li>FASTA (.fasta, .fa)</li> <li>NEXUS (.nex, .nexus)</li> <li>PHYLIP (.phy, .phylip)</li> <li>After upload, you'll see a success message with sequence count and alignment length</li> </ul>"},{"location":"gui_usage/#metadata-file-optional","title":"Metadata File (Optional)","text":"<ul> <li>Click \"\ud83d\udcca Select Metadata File\" </li> <li>Upload a CSV file with population, location, or trait data</li> <li>Required columns: <code>id</code> (matching sequence IDs)</li> <li>Optional columns: <code>population</code>, <code>latitude</code>, <code>longitude</code>, <code>color</code>, <code>notes</code></li> <li>Population data enables:</li> <li>Colored nodes by population</li> <li>Pie charts for nodes with mixed populations</li> <li>Population-based statistics</li> </ul>"},{"location":"gui_usage/#2-configure-algorithm","title":"2. Configure Algorithm","text":"<p>Choose from six network construction algorithms:</p>"},{"location":"gui_usage/#mst-minimum-spanning-tree","title":"MST (Minimum Spanning Tree)","text":"<ul> <li>Parameters: Distance metric (Hamming, Jukes-Cantor, Kimura 2-parameter)</li> <li>Best for: Simplest tree-like relationships without reticulation</li> </ul>"},{"location":"gui_usage/#msn-minimum-spanning-network","title":"MSN (Minimum Spanning Network)","text":"<ul> <li>Parameters: Distance metric</li> <li>Best for: Showing alternative connections at equal distance</li> </ul>"},{"location":"gui_usage/#tcs-statistical-parsimony","title":"TCS (Statistical Parsimony)","text":"<ul> <li>Parameters: Connection limit (1-20 mutations)</li> <li>Best for: Recent divergence, intraspecific analysis</li> <li>Default: 10 mutations</li> </ul>"},{"location":"gui_usage/#mjn-median-joining-network","title":"MJN (Median-Joining Network)","text":"<ul> <li>Parameters: Epsilon value (0 = automatic)</li> <li>Best for: Complex reticulate relationships, infers median vectors</li> </ul>"},{"location":"gui_usage/#pn-parsimony-network","title":"PN (Parsimony Network)","text":"<ul> <li>Parameters: Number of trees to sample (10-500)</li> <li>Best for: Consensus approach capturing phylogenetic uncertainty</li> <li>Default: 100 trees</li> </ul>"},{"location":"gui_usage/#tsw-tight-span-walker","title":"TSW (Tight Span Walker)","text":"<ul> <li>Parameters: Distance metric</li> <li>Best for: Metric-preserving networks, small to medium datasets</li> <li>Note: Computationally intensive</li> </ul> <p>After selecting an algorithm and parameters, click \u26a1 Compute Network.</p>"},{"location":"gui_usage/#3-layout-options","title":"3. Layout Options","text":"<p>Choose how to arrange nodes in the network visualization:</p>"},{"location":"gui_usage/#available-layouts","title":"Available Layouts","text":"<ul> <li>Hierarchical (Fast): Tree-like hierarchical arrangement, quick computation</li> <li>Spring (Force-directed): Physics-based layout, good for general use</li> <li>Spring - Proportional Edge Length: Spring layout where edge length reflects mutation distance</li> <li>Spectral (Fast, Large networks): Eigenvalue-based layout, efficient for large networks</li> <li>Circular: Nodes arranged in a circle</li> <li>Radial: Concentric rings from center</li> <li>Kamada-Kawai (High quality, slow): Energy-minimization layout, best visual quality</li> <li>Kamada-Kawai - Proportional Edge Length: KK layout where edge length reflects mutation distance</li> </ul>"},{"location":"gui_usage/#customization-options","title":"Customization Options","text":"<ul> <li>Node Spacing: Adjust spacing between nodes (0.5x - 3.0x)</li> <li>Node Size: Adjust node size (10 - 100)</li> <li>Edge Width: Adjust edge thickness (1 - 10)</li> </ul> <p>Click \ud83c\udfa8 Apply Layout to recompute node positions with new settings.</p>"},{"location":"gui_usage/#4-viewing-results","title":"4. Viewing Results","text":"<p>The GUI provides five tabs:</p>"},{"location":"gui_usage/#network-tab","title":"Network Tab","text":"<ul> <li>Interactive visualization with Dash Cytoscape</li> <li>Node styling:</li> <li>Size: Proportional to haplotype frequency</li> <li>Color: Single population = solid color, mixed = pie chart</li> <li>Shape: Median vectors shown as gray circles</li> <li>Selection: Click to select (red border), search to highlight</li> <li>Edge styling:</li> <li>Labels: Show mutation count</li> <li>Thickness: Adjustable via slider</li> <li>Interactions:</li> <li>Zoom: Scroll wheel</li> <li>Pan: Click and drag background</li> <li>Move nodes: Drag individual nodes to reposition</li> <li>Hover: View haplotype details in tooltip</li> <li>Search: Use dropdown to find and highlight specific haplotypes</li> <li>Legend: Shows population colors and mixed population indicator</li> </ul>"},{"location":"gui_usage/#statistics-tab","title":"Statistics Tab","text":"<p>Displays comprehensive network metrics:</p> <ul> <li>Basic Metrics: Nodes, edges, diameter, clustering coefficient, reticulation index</li> <li>Diversity Metrics: Haplotype diversity, Shannon index</li> <li>Central Haplotypes: Degree, betweenness, and closeness centrality measures</li> </ul>"},{"location":"gui_usage/#haplotype-summary-tab","title":"Haplotype Summary Tab","text":"<ul> <li>Table view: H number, type (observed/inferred), frequency, sample IDs, populations</li> <li>Export options:</li> <li>Download haplotype summary as CSV</li> <li>Download H number label template</li> <li>Upload custom H number labels</li> <li>Shows which sequences belong to each haplotype</li> <li>Identifies inferred median nodes</li> </ul>"},{"location":"gui_usage/#metadata-tab","title":"Metadata Tab","text":"<ul> <li>View uploaded metadata aligned with sequence IDs</li> <li>Shows which IDs are in alignment vs. metadata</li> <li>Displays population assignments and colors</li> <li>Warns about mismatches or duplicates</li> </ul>"},{"location":"gui_usage/#alignment-tab","title":"Alignment Tab","text":"<ul> <li>View the uploaded sequence alignment</li> <li>Polymorphic sites highlighted in color (A=green, C=blue, G=orange, T=red)</li> <li>Shows first 50 sequences with ID and sequence data aligned</li> </ul>"},{"location":"gui_usage/#5-export","title":"5. Export","text":"<p>Export your results in various formats:</p> <ul> <li>GraphML: Network format, opens in Cytoscape, Gephi</li> <li>GML: Graph Markup Language</li> <li>JSON: JavaScript Object Notation, for web applications</li> <li>PNG: Raster image, good for presentations</li> <li>SVG: Vector image, scalable for publications</li> </ul> <p>Click Download to save the file.</p>"},{"location":"gui_usage/#tips-and-best-practices","title":"Tips and Best Practices","text":""},{"location":"gui_usage/#data-preparation","title":"Data Preparation","text":"<ul> <li>Ensure sequences are aligned before uploading</li> <li>All sequences should have the same length</li> <li>Include metadata in NEXUS format for population coloring</li> </ul>"},{"location":"gui_usage/#algorithm-selection","title":"Algorithm Selection","text":"<ul> <li>Start with MSN for most datasets (good balance)</li> <li>Use TCS for closely related sequences (e.g., same species)</li> <li>Use MJN for complex evolutionary scenarios</li> <li>MST is fastest but simplest</li> </ul>"},{"location":"gui_usage/#layout-optimization","title":"Layout Optimization","text":"<ul> <li>Try different layout algorithms to find the clearest visualization</li> <li>Spring layout works well for most networks</li> <li>Radial layout highlights star-like patterns</li> <li>Enable Snap to Grid for publication-ready figures</li> </ul>"},{"location":"gui_usage/#performance","title":"Performance","text":"<ul> <li>Large datasets (&gt;100 sequences) may take time to compute</li> <li>Progress indicators show when computation is running</li> <li>Network visualization is interactive even with many nodes</li> </ul>"},{"location":"gui_usage/#troubleshooting","title":"Troubleshooting","text":"<p>File Upload Fails</p> <ul> <li>Check file format and extension</li> <li>Ensure sequences are properly formatted</li> <li>Try a smaller test dataset first</li> </ul> <p>Network Computation Fails</p> <ul> <li>Check that all sequences have the same length</li> <li>Reduce connection limit for TCS if very large</li> <li>Try a different algorithm</li> </ul> <p>Visualization Issues</p> <ul> <li>Refresh the browser page</li> <li>Try a different layout algorithm</li> <li>Check browser console for errors (F12)</li> </ul> <p>Export Doesn't Work</p> <ul> <li>Ensure network has been computed</li> <li>Check browser's download settings</li> <li>Try a different export format</li> </ul>"},{"location":"gui_usage/#advanced-features","title":"Advanced Features","text":""},{"location":"gui_usage/#customization","title":"Customization","text":"<p>The GUI can be customized by modifying <code>src/pypopart/gui/app.py</code>:</p> <ul> <li>Adjust default parameters</li> <li>Change color schemes</li> <li>Add custom layout algorithms</li> <li>Modify statistics displayed</li> </ul>"},{"location":"gui_usage/#integration","title":"Integration","text":"<p>The GUI components can be used programmatically:</p> <pre><code>from pypopart.gui.app import PyPopARTApp\n\napp = PyPopARTApp(debug=True, port=8050)\n# Access app.app for the Dash application object\n# Customize before running\napp.run()\n</code></pre>"},{"location":"gui_usage/#support","title":"Support","text":"<p>For issues, questions, or feature requests:</p> <ul> <li>GitHub Issues: https://github.com/adamtaranto/pypopart/issues</li> <li>Documentation: https://github.com/adamtaranto/pypopart</li> </ul>"},{"location":"gui_usage/#citation","title":"Citation","text":"<p>If you use PyPopART in your research, please cite:</p> <p>[Citation information to be added]</p>"},{"location":"h_number_labeling/","title":"Custom H Number Labeling","text":""},{"location":"h_number_labeling/#overview","title":"Overview","text":"<p>The PyPopART Dash app allows users to customize the labels assigned to haplotype groups in network visualizations. By default, haplotypes are labeled sequentially as H1, H2, H3, etc. This feature enables you to replace these default labels with meaningful names for publication or analysis.</p>"},{"location":"h_number_labeling/#use-cases","title":"Use Cases","text":"<ul> <li>Publication-ready figures: Replace H1, H2, H3 with descriptive names like \"Central\", \"Branch_A\", \"Rare_variant\"</li> <li>Geographic populations: Label haplotypes by their predominant location (e.g., \"Pacific\", \"Atlantic\", \"Mediterranean\")</li> <li>Functional groups: Assign labels based on phenotype or functional characteristics</li> <li>Standardization: Use consistent labeling across multiple analyses</li> </ul>"},{"location":"h_number_labeling/#workflow","title":"Workflow","text":""},{"location":"h_number_labeling/#step-1-generate-the-network","title":"Step 1: Generate the Network","text":"<ol> <li>Upload your sequence alignment (FASTA, NEXUS, or PHYLIP format)</li> <li>Optionally upload metadata (population, location data)</li> <li>Select a network algorithm (MST, MSN, TCS, or MJN)</li> <li>Click \"Compute Network\"</li> </ol> <p>The network will be displayed with default labels (H1, H2, H3, etc.)</p>"},{"location":"h_number_labeling/#step-2-download-label-template","title":"Step 2: Download Label Template","text":"<ol> <li>Navigate to the Haplotype Summary tab</li> <li>Click the \"\u2b07\ufe0f Download Label Template\" button</li> <li>Save the CSV file (default name: <code>h_number_mapping_template.csv</code>)</li> </ol> <p>The template CSV contains two columns: - <code>current_h_number</code>: The current H number (H1, H2, H3, etc.) - <code>new_label</code>: Initially set to the same as current_h_number (for you to edit)</p>"},{"location":"h_number_labeling/#step-3-edit-labels","title":"Step 3: Edit Labels","text":"<p>Open the downloaded CSV in any spreadsheet application or text editor:</p> <pre><code>current_h_number,new_label\nH1,H1\nH2,H2\nH3,H3\nH4,H4\n</code></pre> <p>Edit the <code>new_label</code> column with your desired labels:</p> <pre><code>current_h_number,new_label\nH1,Central\nH2,Branch_A\nH3,Branch_B\nH4,Rare_variant\n</code></pre> <p>Important Guidelines: - Keep the <code>current_h_number</code> column unchanged - Do not use duplicate values in the <code>new_label</code> column - Avoid special characters that might cause issues in visualization - Keep labels concise for better readability in plots - Do not leave <code>new_label</code> cells empty</p>"},{"location":"h_number_labeling/#step-4-upload-custom-mapping","title":"Step 4: Upload Custom Mapping","text":"<ol> <li>Return to the Haplotype Summary tab in the app</li> <li>Click the \"\u2b06\ufe0f Upload Label Mapping\" button</li> <li>Select your edited CSV file</li> <li>The system will validate your mapping</li> </ol> <p>If successful: - A green success message appears - The network graph updates with your custom labels - The haplotype summary table shows your custom labels - Search dropdown reflects your custom labels - Tooltips display your custom labels</p> <p>If errors are detected: - A red error message appears with specific issues - Fix the errors in your CSV and try uploading again</p>"},{"location":"h_number_labeling/#validation-rules","title":"Validation Rules","text":"<p>The system performs the following validations:</p>"},{"location":"h_number_labeling/#1-column-format","title":"1. Column Format","text":"<ul> <li>CSV must have exactly two columns: <code>current_h_number</code> and <code>new_label</code></li> <li>Column headers must match exactly (case-sensitive)</li> </ul>"},{"location":"h_number_labeling/#2-unknown-h-numbers","title":"2. Unknown H Numbers","text":"<ul> <li>All <code>current_h_number</code> values must exist in the current network</li> <li>Error example: \"Row 5: Unknown H number 'H99'\"</li> </ul>"},{"location":"h_number_labeling/#3-duplicate-labels","title":"3. Duplicate Labels","text":"<ul> <li>Each <code>new_label</code> must be unique</li> <li>Error example: \"Duplicate label 'Central' for node1 and node2\"</li> </ul>"},{"location":"h_number_labeling/#4-missing-values","title":"4. Missing Values","text":"<ul> <li>Both columns must have values for each row</li> <li>Error example: \"Row 3: Missing new_label for H2\"</li> </ul>"},{"location":"h_number_labeling/#5-whitespace","title":"5. Whitespace","text":"<ul> <li>Leading and trailing whitespace is automatically trimmed</li> <li>Labels like <code>\" Central \"</code> become <code>\"Central\"</code></li> </ul>"},{"location":"h_number_labeling/#example-validation-errors","title":"Example Validation Errors","text":"<pre><code>\u274c Validation Errors:\n\u2022 Row 3: Missing new_label for H2\n\u2022 Row 5: Unknown H number \"H99\"\n\u2022 Duplicate label \"Central\" for H1 and H3\n(3 total errors)\n</code></pre>"},{"location":"h_number_labeling/#tips","title":"Tips","text":"<ol> <li>Start with the template: Always download the current template before editing to ensure you have the correct H numbers</li> <li>Backup your CSV: Keep a copy of your custom mapping for reuse</li> <li>Test with small changes: Try uploading with just a few label changes first</li> <li>Use consistent naming: Establish a naming convention for your labels</li> <li>Avoid unicode: Stick to ASCII characters for maximum compatibility</li> </ol>"},{"location":"h_number_labeling/#persistence","title":"Persistence","text":"<ul> <li>Custom labels persist across layout changes (e.g., switching from hierarchical to spring)</li> <li>Custom labels are not saved with the network export (they're display-only)</li> <li>To reset to default labels, compute a new network or reload the page</li> <li>To update labels, download a fresh template and upload a new mapping</li> </ul>"},{"location":"h_number_labeling/#integration-with-other-features","title":"Integration with Other Features","text":"<ul> <li>Search: Custom labels appear in the search dropdown</li> <li>Tooltips: Hovering over nodes shows custom labels</li> <li>Summary Export: Downloaded CSV includes custom labels</li> <li>Network Export: Exported GraphML/JSON uses original node IDs (not custom labels)</li> </ul>"},{"location":"h_number_labeling/#troubleshooting","title":"Troubleshooting","text":"<p>Problem: Upload button doesn't respond - Solution: Ensure you've computed a network first</p> <p>Problem: Template download is empty - Solution: Compute a network before downloading the template</p> <p>Problem: Custom labels don't appear after upload - Solution: Check the feedback message for validation errors</p> <p>Problem: Labels are too long and overlap in the plot - Solution: Use shorter labels or increase network spacing</p> <p>Problem: Need to start over - Solution: Refresh the page or compute a new network to reset labels</p>"},{"location":"h_number_labeling/#api-reference","title":"API Reference","text":"<p>For programmatic access, see the callback documentation in <code>src/pypopart/gui/app.py</code>: - <code>download_h_number_template()</code>: Generates template CSV - <code>upload_h_number_mapping()</code>: Processes uploaded mapping</p>"},{"location":"h_number_labeling/#example-mappings","title":"Example Mappings","text":""},{"location":"h_number_labeling/#geographic-labeling","title":"Geographic Labeling","text":"<pre><code>current_h_number,new_label\nH1,Pacific_Core\nH2,Atlantic_North\nH3,Atlantic_South\nH4,Mediterranean\n</code></pre>"},{"location":"h_number_labeling/#functional-labeling","title":"Functional Labeling","text":"<pre><code>current_h_number,new_label\nH1,Wildtype\nH2,Resistant\nH3,Tolerant\nH4,Susceptible\n</code></pre>"},{"location":"h_number_labeling/#alphanumeric-labeling","title":"Alphanumeric Labeling","text":"<pre><code>current_h_number,new_label\nH1,A\nH2,B\nH3,C\nH4,D\n</code></pre>"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#requirements","title":"Requirements","text":"<p>PyPopART requires:</p> <ul> <li>Python 3.9 or higher</li> <li>Operating system: Linux, macOS, or Windows</li> </ul>"},{"location":"installation/#installation-methods","title":"Installation Methods","text":""},{"location":"installation/#from-pypi-recommended","title":"From PyPI (Recommended)","text":"<p>Once released, install PyPopART using pip:</p> <pre><code>pip install pypopart\n</code></pre>"},{"location":"installation/#from-source","title":"From Source","text":"<p>For the latest development version:</p> <pre><code># Clone the repository\ngit clone https://github.com/adamtaranto/pypopart.git\ncd pypopart\n\n# Install in development mode\npip install -e \".[dev]\"\n</code></pre>"},{"location":"installation/#using-condamamba","title":"Using conda/mamba","text":"<p>Create a conda environment (optional but recommended):</p> <pre><code># Create environment\nconda create -n pypopart python=3.11\nconda activate pypopart\n\n# Install pypopart\npip install pypopart\n</code></pre>"},{"location":"installation/#dependencies","title":"Dependencies","text":"<p>PyPopART automatically installs the following dependencies:</p>"},{"location":"installation/#core-dependencies","title":"Core Dependencies","text":"<ul> <li>biopython: Sequence I/O and manipulation</li> <li>click: Command-line interface</li> <li>matplotlib: Static visualization</li> <li>networkx: Graph data structures and algorithms</li> <li>numba: JIT compilation for performance</li> <li>numpy: Numerical operations</li> <li>pandas: Data manipulation</li> <li>plotly: Interactive visualization</li> <li>scipy: Scientific computing</li> <li>scikit-learn: Machine learning utilities</li> </ul>"},{"location":"installation/#development-dependencies-optional","title":"Development Dependencies (optional)","text":"<p>For development, install additional tools:</p> <pre><code>pip install pypopart[dev]\n</code></pre> <p>This includes:</p> <ul> <li>pytest: Testing framework</li> <li>pytest-cov: Coverage reporting</li> <li>ruff: Fast linting and formatting</li> <li>mypy: Static type checking</li> <li>pre-commit: Git hooks for code quality</li> </ul>"},{"location":"installation/#verify-installation","title":"Verify Installation","text":"<p>Check that PyPopART is installed correctly:</p> <pre><code># Check version\npypopart --version\n\n# Show help\npypopart --help\n\n# List available commands\npypopart info --list-algorithms\n</code></pre> <p>Expected output:</p> <pre><code>Available Network Construction Algorithms:\n  mst - Minimum Spanning Tree\n  msn - Minimum Spanning Network\n  tcs - Statistical Parsimony (TCS)\n  mjn - Median-Joining Network\n</code></pre>"},{"location":"installation/#testing-your-installation","title":"Testing Your Installation","text":"<p>Run a quick test with sample data:</p> <pre><code># Create a simple FASTA file\ncat &gt; test.fasta &lt;&lt; 'EOF'\n&gt;Seq1\nATCGATCG\n&gt;Seq2\nATCGATCG\n&gt;Seq3\nATCGATTG\nEOF\n\n# Construct a network\npypopart network test.fasta -o test.graphml\n\n# Visualize it\npypopart visualize test.graphml -o test.png\n</code></pre> <p>If these commands succeed, PyPopART is working correctly!</p>"},{"location":"installation/#python-version-compatibility","title":"Python Version Compatibility","text":"<p>PyPopART is tested on:</p> <ul> <li>Python 3.9</li> <li>Python 3.10</li> <li>Python 3.11</li> <li>Python 3.12</li> </ul>"},{"location":"installation/#platform-support","title":"Platform Support","text":"<p>PyPopART works on:</p> <ul> <li>Linux: Fully supported</li> <li>macOS: Fully supported (both Intel and Apple Silicon)</li> <li>Windows: Fully supported (Windows 10+)</li> </ul>"},{"location":"installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"installation/#importerror-no-module-named-pypopart","title":"ImportError: No module named 'pypopart'","text":"<p>The package is not installed. Try:</p> <pre><code>pip install pypopart\n</code></pre>"},{"location":"installation/#command-not-found-pypopart","title":"Command not found: pypopart","text":"<p>The pip install directory is not in your PATH. Try:</p> <pre><code>python -m pypopart --help\n</code></pre> <p>Or add pip's binary directory to your PATH.</p>"},{"location":"installation/#numpyscipy-installation-issues","title":"NumPy/SciPy Installation Issues","text":"<p>On some systems, you may need to install NumPy and SciPy separately first:</p> <pre><code>pip install numpy scipy\npip install pypopart\n</code></pre>"},{"location":"installation/#numba-compilation-warnings","title":"Numba Compilation Warnings","text":"<p>Numba may show warnings on first import. These are normal and can be ignored. The code will work correctly even without JIT compilation.</p>"},{"location":"installation/#visualization-issues-on-headless-servers","title":"Visualization Issues on Headless Servers","text":"<p>If running on a server without a display:</p> <pre><code># Set matplotlib backend\nexport MPLBACKEND=Agg\npypopart visualize network.graphml -o network.png\n</code></pre> <p>Or use interactive HTML output which doesn't require a display:</p> <pre><code>pypopart visualize network.graphml -o network.html --interactive\n</code></pre>"},{"location":"installation/#updating-pypopart","title":"Updating PyPopART","text":"<p>To update to the latest version:</p> <pre><code>pip install --upgrade pypopart\n</code></pre>"},{"location":"installation/#uninstalling","title":"Uninstalling","text":"<p>To remove PyPopART:</p> <pre><code>pip uninstall pypopart\n</code></pre>"},{"location":"installation/#getting-help","title":"Getting Help","text":"<p>If you encounter issues:</p> <ol> <li>Check the FAQ</li> <li>Search GitHub Issues</li> <li>Open a new issue with:</li> <li>Your Python version (<code>python --version</code>)</li> <li>Your OS and version</li> <li>Complete error message</li> <li>Steps to reproduce the problem</li> </ol>"},{"location":"installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start: Create your first haplotype network</li> <li>CLI Guide: Learn the command-line interface</li> <li>Tutorials: Step-by-step examples</li> </ul>"},{"location":"layout_algorithms/","title":"Network Layout Algorithms","text":"<p>This guide helps you choose the best layout algorithm for your haplotype network visualization in PyPopART.</p>"},{"location":"layout_algorithms/#quick-selection-guide","title":"Quick Selection Guide","text":""},{"location":"layout_algorithms/#by-network-size","title":"By Network Size","text":"Network Size Recommended Algorithm Alternative Small (&lt;50 nodes) Kamada-Kawai Force-Directed Medium (50-500 nodes) Force-Directed Spectral Large (&gt;500 nodes) Spectral Hierarchical"},{"location":"layout_algorithms/#by-purpose","title":"By Purpose","text":"Purpose Algorithm Notes General visualization Force-Directed Good balance of speed and quality Fast preview Hierarchical Instant layout, tree structure Large datasets Spectral Maintains structure, very fast Highest quality Kamada-Kawai Slow but optimal for small networks Highlight central node Radial Places important node at center Simple connectivity Circular Shows connection patterns clearly Proportional distances Spring/KK Proportional Edge length reflects mutation count"},{"location":"layout_algorithms/#algorithm-details","title":"Algorithm Details","text":""},{"location":"layout_algorithms/#1-hierarchical-layout","title":"1. Hierarchical Layout","text":"<p>Best for: Fast previews, tree-like structures</p> <p>Speed: \u26a1\u26a1\u26a1\u26a1\u26a1 Fastest (0.14ms for 100 nodes)</p> <p>Quality: \u2b50\u2b50\u2b50 Good for hierarchical data</p> <p>Description: Arranges nodes in levels based on distance from a root node. Creates a tree-like structure that's easy to interpret.</p> <p>Advantages: - Extremely fast, works well for very large networks - Clear hierarchical relationships - Handles disconnected components</p> <p>Disadvantages: - May not show cyclical relationships well - Layout depends on choice of root node</p> <p>Parameters: <pre><code>layout = manager.compute_layout(\n    'hierarchical',\n    root_node='H1',      # Optional: specify root\n    vertical=True,       # True = top-down, False = left-right\n    width=2.0,          # Layout width\n    height=2.0          # Layout height\n)\n</code></pre></p>"},{"location":"layout_algorithms/#2-spectral-layout","title":"2. Spectral Layout","text":"<p>Best for: Large networks (100-1000+ nodes)</p> <p>Speed: \u26a1\u26a1\u26a1\u26a1 Very fast (6.5ms for 100 nodes)</p> <p>Quality: \u2b50\u2b50\u2b50\u2b50 Excellent structure preservation</p> <p>Description: Uses eigenvectors of the graph Laplacian to position nodes. Excellent balance of speed and quality for large networks.</p> <p>Advantages: - Much faster than force-directed or Kamada-Kawai - Reveals clustering and community structure - Good for networks with clear groups</p> <p>Disadvantages: - May produce less aesthetic layouts than force-directed - Requires connected graph (handles disconnected with fallback)</p> <p>Parameters: <pre><code>layout = manager.compute_layout(\n    'spectral',\n    scale=1.0,          # Scale factor\n    center=(0.0, 0.0)   # Center position\n)\n</code></pre></p>"},{"location":"layout_algorithms/#3-force-directed-spring-layout","title":"3. Force-Directed (Spring) Layout","text":"<p>Best for: General purpose, medium networks</p> <p>Speed: \u26a1\u26a1\u26a1 Moderate (26ms for 100 nodes)</p> <p>Quality: \u2b50\u2b50\u2b50\u2b50 Very good aesthetic quality</p> <p>Description: Simulates physical springs between connected nodes. The default choice for most visualizations.</p> <p>Advantages: - Aesthetically pleasing layouts - Works well for most network types - Tunable with iterations parameter</p> <p>Disadvantages: - Slower than spectral or hierarchical - Can be slow for large networks (&gt;500 nodes) - Non-deterministic without seed</p> <p>Parameters: <pre><code>layout = manager.compute_layout(\n    'spring',\n    k=None,             # Optimal distance (None = auto)\n    iterations=50,      # More = better quality but slower\n    seed=42            # For reproducibility\n)\n</code></pre></p> <p>Tuning Tips: - Increase <code>iterations</code> for better quality (try 100-200) - Decrease <code>k</code> to bring nodes closer together - Use <code>seed</code> for consistent layouts across runs</p>"},{"location":"layout_algorithms/#4-kamada-kawai-layout","title":"4. Kamada-Kawai Layout","text":"<p>Best for: Small networks requiring highest quality</p> <p>Speed: \u26a1 Slow (187ms for 100 nodes)</p> <p>Quality: \u2b50\u2b50\u2b50\u2b50\u2b50 Optimal quality</p> <p>Description: Minimizes stress based on graph-theoretic distances. Produces optimal layouts but is computationally expensive.</p> <p>Advantages: - Highest quality layouts - Respects graph distances precisely - Deterministic results</p> <p>Disadvantages: - Very slow for networks &gt;100 nodes - O(N\u00b3) time complexity - Not suitable for interactive use with large networks</p> <p>Parameters: <pre><code>layout = manager.compute_layout(\n    'kamada_kawai',\n    scale=1.0,          # Scale factor\n    center=(0.0, 0.0)   # Center position\n)\n</code></pre></p> <p>Warning: Only use for small networks (&lt;50 nodes) or when layout quality is absolutely critical.</p>"},{"location":"layout_algorithms/#5-circular-layout","title":"5. Circular Layout","text":"<p>Best for: Showing connectivity patterns</p> <p>Speed: \u26a1\u26a1\u26a1\u26a1\u26a1 Very fast (0.16ms for 100 nodes)</p> <p>Quality: \u2b50\u2b50 Simple but effective</p> <p>Description: Arranges nodes evenly spaced around a circle.</p> <p>Advantages: - Extremely fast - Good for comparing edge densities - Works well with node coloring</p> <p>Disadvantages: - Doesn't reflect graph structure - Can be cluttered for dense networks</p> <p>Parameters: <pre><code>layout = manager.compute_layout(\n    'circular',\n    scale=1.0,          # Radius of circle\n    center=(0.0, 0.0)   # Center position\n)\n</code></pre></p>"},{"location":"layout_algorithms/#6-radial-layout","title":"6. Radial Layout","text":"<p>Best for: Networks with clear central node</p> <p>Speed: \u26a1\u26a1\u26a1\u26a1 Fast (0.26ms for 100 nodes)</p> <p>Quality: \u2b50\u2b50\u2b50 Good for star-like networks</p> <p>Description: Places a central node at origin, others in concentric rings based on distance.</p> <p>Advantages: - Fast and intuitive - Highlights central hub - Shows distance from center clearly</p> <p>Disadvantages: - Works best for star-like topologies - May be cluttered if many nodes at same distance</p> <p>Parameters: <pre><code>layout = manager.compute_layout(\n    'radial',\n    center_node='H1',   # Node to place at center\n    scale=1.0           # Scale factor\n)\n</code></pre></p>"},{"location":"layout_algorithms/#7-proportional-edge-length-layouts","title":"7. Proportional Edge Length Layouts","text":"<p>Best for: Showing mutation distances accurately</p> <p>Speed: \u26a1\u26a1\u26a1 Moderate (similar to base algorithms)</p> <p>Quality: \u2b50\u2b50\u2b50\u2b50 Accurate distance representation</p> <p>Description: Variations of spring and Kamada-Kawai layouts where edge lengths are proportional to the number of mutations between haplotypes.</p> <p>Advantages: - Visually represents genetic distance - Helps identify distant vs. close relationships - Useful for understanding evolutionary distances</p> <p>Disadvantages: - Can produce larger, more spread-out layouts - May reduce aesthetic appeal for highly variable data</p> <p>Available Variations:</p>"},{"location":"layout_algorithms/#spring-proportional","title":"Spring Proportional","text":"<pre><code>layout = manager.compute_layout(\n    'spring_proportional',\n    iterations=100,\n    seed=42\n)\n</code></pre>"},{"location":"layout_algorithms/#kamada-kawai-proportional","title":"Kamada-Kawai Proportional","text":"<pre><code>layout = manager.compute_layout(\n    'kamada_kawai_proportional',\n    scale=1.0\n)\n</code></pre>"},{"location":"layout_algorithms/#performance-benchmarks","title":"Performance Benchmarks","text":"<p>All benchmarks run on standard hardware with Python 3.12, NetworkX 3.5.</p>"},{"location":"layout_algorithms/#runtime-comparison-100-nodes","title":"Runtime Comparison (100 nodes)","text":"<pre><code>Hierarchical:     0.14 ms  \u26a1\u26a1\u26a1\u26a1\u26a1\nCircular:         0.16 ms  \u26a1\u26a1\u26a1\u26a1\u26a1\nRadial:           0.26 ms  \u26a1\u26a1\u26a1\u26a1\u26a1\nSpectral:         6.50 ms  \u26a1\u26a1\u26a1\u26a1\nForce-Directed:  26.00 ms  \u26a1\u26a1\u26a1\nKamada-Kawai:   187.00 ms  \u26a1\n</code></pre>"},{"location":"layout_algorithms/#scalability-200-nodes","title":"Scalability (200 nodes)","text":"<pre><code>Hierarchical:      0.28 ms\nSpectral:         23.88 ms\nForce-Directed:   87.00 ms\nKamada-Kawai:   1202.00 ms  \u26a0\ufe0f Not recommended\n</code></pre>"},{"location":"layout_algorithms/#best-practices","title":"Best Practices","text":""},{"location":"layout_algorithms/#1-start-fast-refine-later","title":"1. Start Fast, Refine Later","text":"<p>For exploratory analysis: 1. Use Hierarchical for quick preview 2. Switch to Force-Directed for publication 3. Try Spectral if force-directed is too slow</p>"},{"location":"layout_algorithms/#2-consider-network-properties","title":"2. Consider Network Properties","text":"<ul> <li>Clustered networks: Use Spectral</li> <li>Hierarchical networks: Use Hierarchical</li> <li>Star topologies: Use Radial</li> <li>Dense networks: Use Circular or Spectral</li> </ul>"},{"location":"layout_algorithms/#3-optimization-tips","title":"3. Optimization Tips","text":"<p>For large networks: - Reduce force-directed iterations: <code>iterations=30</code> - Use spectral instead of force-directed - Consider hierarchical for fastest results</p> <p>For highest quality: - Increase iterations: <code>iterations=100-200</code> - Use Kamada-Kawai for small networks - Set consistent seed for reproducibility</p>"},{"location":"layout_algorithms/#4-interactive-workflows","title":"4. Interactive Workflows","text":"<pre><code># Quick preview\nlayout = manager.compute_layout('hierarchical')\n\n# If network is small (&lt;100 nodes), upgrade to force-directed\nif len(network.nodes) &lt; 100:\n    layout = manager.compute_layout('spring', iterations=100, seed=42)\n\n# For large networks, use spectral\nif len(network.nodes) &gt; 500:\n    layout = manager.compute_layout('spectral')\n</code></pre>"},{"location":"layout_algorithms/#common-issues-and-solutions","title":"Common Issues and Solutions","text":""},{"location":"layout_algorithms/#layout-looks-cluttered","title":"Layout looks cluttered","text":"<p>Problem: Nodes overlap or edges cross excessively</p> <p>Solutions: - Increase iterations for force-directed: <code>iterations=100</code> - Try spectral layout for better spacing - Use radial or circular for clearer structure</p>"},{"location":"layout_algorithms/#layout-is-too-slow","title":"Layout is too slow","text":"<p>Problem: Layout computation takes too long</p> <p>Solutions: - Switch to spectral or hierarchical - Reduce iterations: <code>iterations=30</code> - Use hierarchical for instant preview</p>"},{"location":"layout_algorithms/#disconnected-components-overlap","title":"Disconnected components overlap","text":"<p>Problem: Separate network components are positioned on top of each other</p> <p>Solutions: - Use force-directed or spectral (handle components automatically) - Manually adjust with ManualLayout after initial computation</p>"},{"location":"layout_algorithms/#layout-changes-every-time","title":"Layout changes every time","text":"<p>Problem: Non-deterministic layouts make comparison difficult</p> <p>Solutions: - Set seed for force-directed: <code>seed=42</code> - Use deterministic algorithms: Hierarchical, Kamada-Kawai, Circular, Radial</p>"},{"location":"layout_algorithms/#advanced-usage","title":"Advanced Usage","text":""},{"location":"layout_algorithms/#combining-layouts","title":"Combining Layouts","text":"<p>You can start with one algorithm and refine with another:</p> <pre><code># Start with fast hierarchical\ninitial = manager.compute_layout('hierarchical')\n\n# Refine with force-directed (fewer iterations)\nrefined = manager.compute_layout('spring', iterations=30, pos=initial)\n</code></pre>"},{"location":"layout_algorithms/#manual-adjustments","title":"Manual Adjustments","text":"<p>After automatic layout, use ManualLayout for fine-tuning:</p> <pre><code># Compute initial layout\npositions = manager.compute_layout('spring')\n\n# Create manual layout for adjustments\nmanual = ManualLayout(network, initial_positions=positions)\n\n# Move a specific node\nmanual.set_position('H5', (1.0, 2.0))\n\n# Get final positions\nfinal = manual.compute()\n</code></pre>"},{"location":"layout_algorithms/#saving-and-loading-layouts","title":"Saving and Loading Layouts","text":"<p>Save time by reusing layouts:</p> <pre><code># Compute and save\nlayout = manager.compute_layout('spring', iterations=200, seed=42)\nmanager.save_layout(layout, 'my_network_layout.json')\n\n# Load later\nlayout = manager.load_layout('my_network_layout.json')\n</code></pre>"},{"location":"layout_algorithms/#references","title":"References","text":"<ul> <li>NetworkX Layouts: https://networkx.org/documentation/stable/reference/drawing.html</li> <li>Fruchterman-Reingold: \"Graph Drawing by Force-directed Placement\" (1991)</li> <li>Kamada-Kawai: \"An Algorithm for Drawing General Undirected Graphs\" (1989)</li> <li>Spectral Layout: Uses Laplacian eigendecomposition (Koren 2005)</li> </ul>"},{"location":"layout_algorithms/#getting-help","title":"Getting Help","text":"<p>If you're unsure which layout to use:</p> <ol> <li>Try Hierarchical first - it's instant and often good enough</li> <li>If that doesn't work well, try Force-Directed with default settings</li> <li>For large networks (&gt;500 nodes), use Spectral</li> <li>To show mutation distances accurately, try Spring Proportional or Kamada-Kawai Proportional</li> </ol> <p>For questions or issues, please see the main PyPopART documentation or open an issue on GitHub.</p>"},{"location":"quickstart/","title":"Quick Start Guide","text":"<p>Get started with PyPopART in minutes! This guide walks you through creating your first haplotype network.</p>"},{"location":"quickstart/#prerequisites","title":"Prerequisites","text":"<ul> <li>PyPopART installed (see Installation)</li> <li>A sequence alignment file (FASTA, NEXUS, PHYLIP, or GenBank format)</li> </ul>"},{"location":"quickstart/#choosing-your-interface","title":"Choosing Your Interface","text":"<p>PyPopART offers two ways to work with haplotype networks:</p>"},{"location":"quickstart/#option-1-web-based-gui-recommended-for-beginners","title":"Option 1: Web-based GUI (Recommended for Beginners)","text":"<p>Launch the interactive interface:</p> <pre><code>pypopart-gui\n</code></pre> <p>Open your browser to <code>http://localhost:8050</code> and follow the visual workflow: 1. Upload sequence file 2. Configure algorithm 3. Compute network 4. Customize layout 5. Export results</p> <p>Advantages: Visual, interactive, no command-line knowledge needed.</p>"},{"location":"quickstart/#option-2-command-line-interface","title":"Option 2: Command-Line Interface","text":"<p>For automation and scripting, use the CLI as shown below.</p>"},{"location":"quickstart/#your-first-network-in-3-steps-cli","title":"Your First Network in 3 Steps (CLI)","text":""},{"location":"quickstart/#step-1-prepare-your-data","title":"Step 1: Prepare Your Data","text":"<p>Create or use an existing sequence alignment. For this example, we'll create a simple FASTA file:</p> <pre><code>cat &gt; mysequences.fasta &lt;&lt; 'EOF'\n&gt;Sample1_PopA\nATCGATCGATCGATCGATCG\n&gt;Sample2_PopA\nATCGATCGATCGATCGATCG\n&gt;Sample3_PopB\nATCGATCGATCGATTGATCG\n&gt;Sample4_PopB\nATCGATCGATCGATTGATCG\n&gt;Sample5_PopC\nATCGATCGAGCGATCGATCG\nEOF\n</code></pre>"},{"location":"quickstart/#step-2-construct-the-network","title":"Step 2: Construct the Network","text":"<p>Use the <code>network</code> command to build a haplotype network:</p> <pre><code>pypopart network mysequences.fasta -o mynetwork.graphml\n</code></pre> <p>Output:</p> <pre><code>Loading sequences from mysequences.fasta...\n\u2713 Loaded 5 sequences (20 bp)\nCalculating hamming distances...\n\u2713 Distance matrix computed\nIdentifying unique haplotypes...\n\u2713 Found 3 unique haplotypes\nBuilding MJN network...\n\u2713 Network constructed\n\nNetwork Statistics:\n  Nodes: 3\n  Edges: 2\n  Median vectors: 0\n\n\u2713 Network saved as GRAPHML\n</code></pre>"},{"location":"quickstart/#step-3-visualize-the-network","title":"Step 3: Visualize the Network","text":"<p>Create a visualization:</p> <pre><code>pypopart visualize mynetwork.graphml -o mynetwork.png\n</code></pre> <p>Or create an interactive HTML visualization:</p> <pre><code>pypopart visualize mynetwork.graphml -o mynetwork.html --interactive\n</code></pre> <p>That's it! You've created your first haplotype network.</p>"},{"location":"quickstart/#exploring-further","title":"Exploring Further","text":""},{"location":"quickstart/#try-different-algorithms","title":"Try Different Algorithms","text":"<p>PyPopART offers six network construction algorithms:</p> <pre><code># Minimum Spanning Tree (simplest tree)\npypopart network mysequences.fasta -a mst -o network_mst.graphml\n\n# Minimum Spanning Network (shows alternatives)\npypopart network mysequences.fasta -a msn -o network_msn.graphml\n\n# Statistical Parsimony (TCS)\npypopart network mysequences.fasta -a tcs -o network_tcs.graphml\n\n# Median-Joining (default, infers ancestors)\npypopart network mysequences.fasta -a mjn -o network_mjn.graphml\n\n# Parsimony Network (consensus from multiple trees)\npypopart network mysequences.fasta -a pn -o network_pn.graphml\n\n# Tight Span Walker (metric-preserving, for small datasets)\npypopart network mysequences.fasta -a tsw -o network_tsw.graphml\n</code></pre> <p>Algorithm Comparison: - MST: Fastest, simplest tree - MSN: Adds alternative equal-distance connections - TCS: Best for closely related sequences - MJN: Infers ancestral sequences, handles reticulation - PN: Consensus approach, captures uncertainty - TSW: Most accurate metric preservation (slower)</p>"},{"location":"quickstart/#use-different-distance-metrics","title":"Use Different Distance Metrics","text":"<pre><code># Hamming distance (default, fastest)\npypopart network mysequences.fasta -d hamming -o network.graphml\n\n# Jukes-Cantor correction\npypopart network mysequences.fasta -d jc -o network.graphml\n\n# Kimura 2-parameter\npypopart network mysequences.fasta -d k2p -o network.graphml\n\n# Tamura-Nei (most complex)\npypopart network mysequences.fasta -d tamura_nei -o network.graphml\n</code></pre>"},{"location":"quickstart/#analyze-your-network","title":"Analyze Your Network","text":"<p>Get comprehensive statistics:</p> <pre><code>pypopart analyze mynetwork.graphml --stats\n</code></pre> <p>Output:</p> <pre><code>Loading network from mynetwork.graphml...\n\u2713 Loaded network with 3 nodes\n\n=== Network Statistics ===\nnodes: 3\nedges: 2\ndiameter: 2\navg_degree: 1.333\nclustering_coefficient: 0.0000\nreticulation_index: 0.0000\n</code></pre>"},{"location":"quickstart/#customize-visualizations","title":"Customize Visualizations","text":"<pre><code># Different layout algorithms\npypopart visualize mynetwork.graphml -o net.png --layout circular\npypopart visualize mynetwork.graphml -o net.png --layout radial\n\n# Show node labels\npypopart visualize mynetwork.graphml -o net.png --show-labels\n\n# Custom size\npypopart visualize mynetwork.graphml -o net.png --width 1200 --height 900\n\n# Save as PDF (publication-ready)\npypopart visualize mynetwork.graphml -o net.pdf\n</code></pre>"},{"location":"quickstart/#using-the-python-api","title":"Using the Python API","text":"<p>For more control, use Python directly:</p> <pre><code>from pypopart.io import load_alignment\nfrom pypopart.core.distance import DistanceCalculator\nfrom pypopart.core.condensation import condense_alignment\nfrom pypopart.algorithms import MJNAlgorithm\nfrom pypopart.visualization import StaticVisualizer\n\n# Load sequences\nalignment = load_alignment('mysequences.fasta')\nprint(f\"Loaded {len(alignment)} sequences\")\n\n# Calculate distances\ncalculator = DistanceCalculator(method='k2p')\ndistances = calculator.calculate_matrix(alignment)\n\n# Identify haplotypes\nhaplotypes, freq_map = condense_alignment(alignment)\nprint(f\"Found {len(haplotypes)} unique haplotypes\")\n\n# Construct network\nmjn = MJNAlgorithm(epsilon=0)\nnetwork = mjn.construct_network(haplotypes, distances)\n\n# Visualize\nviz = StaticVisualizer(network)\nviz.plot(\n    layout_algorithm='spring',\n    show_labels=True,\n    output_file='network.png'\n)\n</code></pre>"},{"location":"quickstart/#common-workflows","title":"Common Workflows","text":""},{"location":"quickstart/#workflow-1-basic-analysis","title":"Workflow 1: Basic Analysis","text":"<pre><code># 1. Load and inspect data\npypopart load mysequences.fasta\n\n# 2. Build network\npypopart network mysequences.fasta -o network.graphml\n\n# 3. Analyze\npypopart analyze network.graphml --stats --topology\n\n# 4. Visualize\npypopart visualize network.graphml -o network.png\n</code></pre>"},{"location":"quickstart/#workflow-2-algorithm-comparison","title":"Workflow 2: Algorithm Comparison","text":"<pre><code># Try all algorithms\nfor algo in mst msn tcs mjn pn tsw; do\n    pypopart network mysequences.fasta -a $algo -o network_${algo}.graphml\n    pypopart visualize network_${algo}.graphml -o network_${algo}.png\ndone\n</code></pre>"},{"location":"quickstart/#workflow-3-gui-based-analysis","title":"Workflow 3: GUI-based Analysis","text":"<p>For an interactive workflow:</p> <pre><code># Launch GUI\npypopart-gui\n\n# Then use the web interface to:\n# 1. Upload sequences and optional metadata\n# 2. Try different algorithms with real-time parameter adjustment\n# 3. Visualize with multiple layout options\n# 4. Drag nodes to reposition\n# 5. Export in various formats\n</code></pre>"},{"location":"quickstart/#workflow-4-with-metadata","title":"Workflow 4: With Metadata","text":"<p>If you have population or location data:</p> <pre><code># Create metadata file (metadata.csv)\ncat &gt; metadata.csv &lt;&lt; 'EOF'\nid,population,location\nSample1,PopA,Site1\nSample2,PopA,Site1\nSample3,PopB,Site2\nSample4,PopB,Site2\nSample5,PopC,Site3\nEOF\n\n# Load with metadata\npypopart load mysequences.fasta -m metadata.csv\n\n# Visualize colored by population\npypopart visualize network.graphml -o network.png --color-by population\n</code></pre>"},{"location":"quickstart/#next-steps","title":"Next Steps","text":"<p>Now that you've created your first network, learn more:</p> <ul> <li>CLI Guide: Complete command-line reference</li> <li>Algorithms: Choosing the right algorithm</li> <li>Tutorials: Detailed examples</li> <li>API Reference: Python API documentation</li> </ul>"},{"location":"quickstart/#getting-help","title":"Getting Help","text":"<ul> <li>Run <code>pypopart --help</code> for command help</li> <li>Run <code>pypopart COMMAND --help</code> for specific command help</li> <li>See FAQ for common questions</li> <li>Check GitHub Issues for known problems</li> </ul>"},{"location":"quickstart/#tips","title":"Tips","text":"<p>Performance</p> <p>For large datasets (&gt;1000 sequences), consider:</p> <ul> <li>Using MST or MSN instead of MJN for speed</li> <li>Using Hamming distance instead of more complex models</li> <li>Increasing epsilon parameter for MJN to reduce complexity</li> </ul> <p>Visualization</p> <ul> <li>PNG for presentations and documents</li> <li>PDF for publications (vector format, scalable)</li> <li>SVG for web use</li> <li>HTML for interactive exploration</li> </ul> <p>File Formats</p> <ul> <li>GraphML preserves all network attributes (recommended)</li> <li>JSON for web applications</li> <li>NEXUS for PopART compatibility</li> </ul> <p>Happy network building! \ud83c\udf33</p>"},{"location":"algorithms/tsw/","title":"Tight Span Walker (TSW) - Parsimony Network Algorithm","text":""},{"location":"algorithms/tsw/#overview","title":"Overview","text":"<p>The Tight Span Walker (TSW) algorithm constructs haplotype networks using parsimony principles by computing the tight span of a distance matrix. The tight span is the smallest metric space that contains all optimal paths between sequences, making it ideal for representing complex evolutionary relationships with reticulation events.</p>"},{"location":"algorithms/tsw/#algorithm-details","title":"Algorithm Details","text":""},{"location":"algorithms/tsw/#how-it-works","title":"How It Works","text":"<ol> <li>Compute dT Distances (Tree Metric)</li> <li>For each pair of sequences (i, j), calculate: <code>dT(i,j) = max over all k of |d(i,k) - d(j,k)|</code></li> <li> <p>This represents the minimum distance if sequences were constrained to a tree structure</p> </li> <li> <p>Build Geodesic Paths</p> </li> <li>For each pair of haplotypes, construct the geodesic (shortest) path</li> <li>Compare the actual distance with the dT distance</li> <li> <p>If <code>actual_distance - dT_distance &gt; epsilon</code>, infer intermediate median vertices</p> </li> <li> <p>Infer Median Vertices</p> </li> <li>When needed, create intermediate (ancestral) nodes</li> <li> <p>Medians represent hypothetical ancestral or intermediate sequences</p> </li> <li> <p>Construct Network</p> </li> <li>Connect all haplotypes through geodesic paths</li> <li>Include inferred median vertices to maintain metric properties</li> </ol>"},{"location":"algorithms/tsw/#key-features","title":"Key Features","text":"<ul> <li>Metric Preservation: Maintains all distance relationships from original data</li> <li>Reticulate Networks: Can represent complex relationships</li> <li>Ancestral Inference: Automatically infers hypothetical ancestral sequences</li> <li>Parsimony-Based: Uses parsimony principles</li> </ul>"},{"location":"algorithms/tsw/#parameters","title":"Parameters","text":"<ul> <li>epsilon (float, default=1e-6): Tolerance for metric comparisons</li> <li>distance_method (str, default='hamming'): Distance calculation method</li> </ul>"},{"location":"algorithms/tsw/#when-to-use-tsw","title":"When to Use TSW","text":"<p>\u2713 Complex evolutionary relationships with reticulation \u2713 Small to medium datasets (n &lt; 100) \u2713 Accurate metric representation needed \u2713 Ancestral sequence inference desired</p>"},{"location":"algorithms/tsw/#usage-example","title":"Usage Example","text":"<pre><code>from pypopart.algorithms import TightSpanWalker\nfrom pypopart.io import load_alignment\n\nalignment = load_alignment('sequences.fasta')\ntsw = TightSpanWalker(distance_method='hamming')\nnetwork = tsw.construct_network(alignment)\n</code></pre>"},{"location":"algorithms/tsw/#references","title":"References","text":"<ol> <li>Dress, A. W., &amp; Huson, D. H. (2004). Constructing splits graphs. IEEE/ACM Transactions on Computational Biology and Bioinformatics, 1(3), 109-115.</li> <li>Bryant, D., &amp; Moulton, V. (2004). Neighbor-Net. Molecular Biology and Evolution, 21(2), 255-265.</li> </ol>"}]}